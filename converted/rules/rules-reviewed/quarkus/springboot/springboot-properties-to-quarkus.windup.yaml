metadata:
- description: "\n            This ruleset gives hints to migrate from SpringBoot
    Configuration Properties to Quarkus spring-boot-properties extension\n        "
  dependencies:
    addon:
    - id: org.jboss.windup.rules,windup-rules-javaee,3.0.0.Final
    - id: org.jboss.windup.rules,windup-rules-java,3.0.0.Final
    - id: org.jboss.windup.rules,windup-rules-xml,3.0.0.Final
  sourceTechnology:
  - id: springboot
  targetTechnology:
  - id: quarkus
rules:
  rule:
  - when:
      dependency:
      - groupId: org.springframework.boot
        artifactId: spring-boot
    perform:
      hint:
      - message: "\n                        Replace the SpringBoot artifact with Quarkus
          `spring-boot-properties` extension\n\n                        Spring Configuration
          Properties is in spring-boot artifact brought transitively by any `org.springframework.boot:spring-boot-*`
          dependency\n                        Add Quarkus dependency `io.quarkus:quarkus-spring-boot-properties`\n
          \                   "
        link:
        - value: ""
          title: Quarkus Spring Configuration Properties Guide
          href: https://quarkus.io/guides/spring-boot-properties
        title: Replace the SpringBoot artifact with Quarkus 'spring-boot-properties'
          extension
        category-id: mandatory
        effort: 1
  - when:
      file:
      - filename: application-{profile}.{extension}
    perform:
      hint:
      - message: "\n                        Spring property profile in separate file
          'application-{profile}.{extension}' must have\n                        their
          individual properties refactored to use Quarkus profile naming conventions
          within a single properties file,\n\n                        ie in the format
          \ %{profile}.config.key=value\n                    "
        link:
        - value: ""
          title: Quarkus Configuring Your Application Guide
          href: https://quarkus.io/guides/config#configuration-profiles
        - value: ""
          title: Quarkus Configuration Reference Guide
          href: https://quarkus.io/guides/config-reference#configuration_profiles
        title: Spring property profiles in separate files must be refactored into
          Quarkus properties file
        category-id: mandatory
        effort: 1
    where:
    - matches:
      - pattern: .+
      param: profile
    - matches:
      - pattern: (properties|yml|yaml)
      param: extension
  - when:
      filecontent:
      - pattern: spring.datasource
        filename: application{profile}.{extension}
    perform:
      hint:
      - message: "\n                        Spring datasource property key/value pairs
          have been detected in the application property file.\n\n                        View
          advice in the Quarkus datasource guide to convert these to Quarkus datasource
          properties.\n                    "
        link:
        - value: ""
          title: Quarkus Datasources Guide
          href: https://quarkus.io/guides/datasource
        title: Replace Spring datasource property key/value pairs with Quarkus properties
        category-id: mandatory
        effort: 1
    where:
    - matches:
      - pattern: .*
      param: profile
    - matches:
      - pattern: (properties|yml|yaml)
      param: extension
  - when:
      filecontent:
      - pattern: logging.level.org.springframework
        filename: application{profile}.{extension}
    perform:
      hint:
      - message: "\n                        Spring log level property configuration
          have been detected in the application property file.\n\n                        View
          advice in the Quarkus datasource guide to convert these to Quarkus log level
          properties.\n                    "
        link:
        - value: ""
          title: Quarkus Configuring Logging Guide
          href: https://quarkus.io/guides/logging#runtime-configuration
        title: Replace Spring log level property with Quarkus property
        category-id: mandatory
        effort: 1
    where:
    - matches:
      - pattern: .*
      param: profile
    - matches:
      - pattern: (properties|yml|yaml)
      param: extension
  - when:
      filecontent:
      - pattern: spring.jpa.hibernate.ddl-auto=create-drop
        filename: application{profile}.{extension}
    perform:
      hint:
      - message: "\n                        Replace `spring.jpa.hibernate.ddl-auto=create-drop`
          with `quarkus.hibernate-orm.database.generation=drop-and-create`\n                    "
        link:
        - value: ""
          title: Quarkus Hibernate ORM and JPA Guide
          href: https://quarkus.io/guides/hibernate-orm
        title: Replace Spring JPA Hiberate property with Quarkus property
        category-id: mandatory
        effort: 1
    where:
    - matches:
      - pattern: .*
      param: profile
    - matches:
      - pattern: (properties|yml|yaml)
      param: extension
  - when:
      filecontent:
      - pattern: springdoc.swagger-ui.path
        filename: application{profile}.{extension}
    perform:
      hint:
      - message: "\n                        Replace `springdoc.swagger-ui.path` with
          `quarkus.swagger-ui.path`\n                        \n                        By
          adding `quarkus.swagger-ui.always-include=true` Quarkus will always expose
          the Swagger UI endpoint. \n                        It is only exposed in
          Dev mode by default.\n                    "
        link:
        - value: ""
          title: Quarkus Guide - using OpenAPI and Swagger
          href: https://quarkus.io/guides/openapi-swaggerui
        quickfix:
        - replacement: quarkus.swagger-ui.path
          search: springdoc.swagger-ui.path
          type: REPLACE
          name: swagger-ui-replace
        title: Replace Spring Swagger endpoint mapping
        category-id: mandatory
        effort: 1
    where:
    - matches:
      - pattern: .*
      param: profile
    - matches:
      - pattern: (properties|yml|yaml)
      param: extension
  - when:
      filecontent:
      - pattern: springdoc.api-docs.path
        filename: application{profile}.{extension}
    perform:
      hint:
      - message: "\n                        Replace `springdoc.api-docs.path` with
          `quarkus.smallrye-openapi.path`\n                        \n                    "
        link:
        - value: ""
          title: Quarkus Guide - using OpenAPI and Swagger
          href: https://quarkus.io/guides/openapi-swaggerui
        quickfix:
        - replacement: quarkus.smallrye-openapi.path
          search: springdoc.api-docs.path
          type: REPLACE
          name: openapi-replace
        title: Replace Spring OpenAPI endpoint mapping
        category-id: mandatory
        effort: 1
    where:
    - matches:
      - pattern: .*
      param: profile
    - matches:
      - pattern: (properties|yml|yaml)
      param: extension
sourceFile: http://github.com/windup/windup-rulesets/tree/master/rules/rules-reviewed/quarkus/springboot/springboot-properties-to-quarkus.windup.xml
